"use strict";angular.module("angularApp",["ngAnimate","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",reloadOnSearch:!1}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("angularApp").controller("MainCtrl",["$scope","$http","$location",function(a,b,c){var d=SRG.PlayerManager.getPlayer("player");a.query=c.search().q,a.$watch("query",_.debounce(function(){a.$apply(function(){a.active=void 0,d.stop(),void 0!==e&&clearTimeout(e),c.search("q",a.query).replace(),b({url:"/search",params:{q:a.query}}).success(function(b,c,d,e){if(e.params.q===a.query){a.shows=b;var f=b[0].episodes[0];f&&f.matches&&a.activate(f)}})})}),200),a.seek=function(a){void 0!==e&&clearTimeout(e),d.seek((+a.start-+a.duration)/1e3)};var e;a.activate=function(c){a.active=c,a.transcript=[],d.load("urn:srf:ais:video:"+c.videoId),d.play(),setTimeout(function(){d.getUrn(function(b){b!=="urn:srf:ais:video:"+a.active.videoId&&a.activate(a.active)})},1e3);var f=new RegExp(a.query.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gi");b.get("/"+c.transcript).success(function(b){function c(){void 0!==e&&clearTimeout(e);var b=d.shift();b&&(a.seek(b),e=setTimeout(function(){c()},3*b.duration))}a.transcript=d3.tsv.parse(b),a.transcript.forEach(function(a){a.matches=a.text.match(f),a.matchText=a.text.replace(f,"<mark>$&</mark>")});var d=a.transcript.filter(function(a){return a.matches});c()})}}]),angular.module("angularApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);